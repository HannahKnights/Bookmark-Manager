<h1>Welcome to bookmark manager</h1>

<div id="user_management">
<a href='/users/new'>Sign up</a>
<a href='/sessions/new'>Sign in</a>
</div>

<% if params[:text] != nil %>
Links tagged with '<%= params[:text] %>'
<% else %> Current links:
<% end %>

<ul>
  <% @links.each do |link| %>
    <li><a href='<%= link.url %>' target='_blank'><%= link.title %></a>
    <%= link.description %>
    <% link_id = link.id %>
    <% link_tags = LinkTag.all(:link_id => link_id) %>
    <% link_tags.each do |link_tag| %>
    <% tag_name = Tag.first(:id => link_tag.tag_id).text %>
    <a href='/tags/<%= tag_name %>'><%= tag_name %></a>
    <% end %>
    <%= LinkUser.all.count(:link_id => link.id) %>
    <% user = User.first(:id => link.user_id) %>
    <%= user.username != nil ? user.username : user.email %>  
    <form action='/favourites' method='post'>
    <input type='hidden' name='favourite_link' value='<%= link.id %>'>
    <input type='submit' value='Add to favourites'>
    </form>
    </li>
  <% end %>
</ul>

Available tags:
<ul>
  <% @tags.each do |tag| %>
    <li><%= tag.text %></li>
  <% end %>
</ul>

<% if current_user %>
  <div id="new_link">
    <form action="/bookmarks" method="post">
      
      <input type="text" name="url" placeholder="URL">

      <input type="text" name="title" placeholder="Title">

      <input type="text" name="description" placeholder="Description">

      <input type="text" name="tags" placeholder="Tags">

      <button type="submit">Add link</button>

    </form>
  </div>
<% end %>
